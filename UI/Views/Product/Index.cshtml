
@section styles{
    <link rel="stylesheet" href="~/plugins/Datatable/datatables-bs4/css/dataTables.bootstrap4.min.css">
<link rel="stylesheet" href="~/plugins/Datatable/datatables-responsive/css/responsive.bootstrap4.min.css">
<link rel="stylesheet" href="~/plugins/Datatable/datatables-buttons/css/buttons.bootstrap4.min.css">
}

<div class="row">
    <div class="col">
        <div class="card">
            <div class="card-header bg-secondary">@ViewData["MenuTitle"]</div>
            <div class="card-body">
                <div class="row">
                    <div class="col mb-3">
                        <a asp-action="CreateProduct" asp-controller="Product" class="btn btn-secondary">Add</a>
                    </div>
                </div>
                <div class="row">
@*                    <input type="hidden" name="__RequestVerificationToken" id="__RequestVerificationToken" value="@GetAntiXsrfRequestToken()" />
*@                    <div class="col">
                        <table class="table table-striped table-bordered" aria-describedby="mydesc" id="productDatatable" style="width:100%">
                            <thead>
                                <tr>
                                    <th scope="col">SN</th>
                                    <th scope="col">Product Name</th>
                                    <th scope="col">Product Code</th>
                                    <th scope="col">Product Parent</th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
@section Scripts{
     <!-- DataTables  & Plugins -->
    <script src="~/plugins/Datatable/datatables/jquery.dataTables.min.js"></script>
    <script src="~/plugins/Datatable/datatables-bs4/js/dataTables.bootstrap4.min.js"></script>
    <script src="~/plugins/Datatable/datatables-responsive/js/dataTables.responsive.min.js"></script>
    <script src="~/plugins/Datatable/datatables-responsive/js/responsive.bootstrap4.min.js"></script>
    <script src="~/plugins/Datatable/datatables-buttons/js/dataTables.buttons.min.js"></script>
    <script src="~/plugins/Datatable/datatables-buttons/js/buttons.bootstrap4.min.js"></script>



    <script asp-append-version=true>
    var dataTable;
    $(document).ready(function () {
        loadDataTable();
    });

    function loadDataTable() {
        dataTable = $("#productDatatable").DataTable({
            "processing": true,
            "autoWidth": true,
            "searching": true,
            "serverSide": true,
            "responsive": true,
            "ordering": true,
            "deferRender": true,
            "filter": true,
            "stateSave": true,
            "stateDuration": 60,
            "ajax": {
                "url": "@Url.Action("GetProductDTResult")",
                "type": "POST",
                "datatype": "json",
                //"headers": { 'RequestVerificationToken': $('#__RequestVerificationToken').val() },
                "data": {},
            },
            //"rowCallback": function (nRow, aData, iDisplayIndex) {
            //        var oSettings = this.fnSettings();
            //        $("td:first", nRow).html(oSettings._iDisplayStart + iDisplayIndex + 1);
            //        return nRow;
            //},
            "columns": [
                 { "data": "productId" ,"name": "ProductId","searchable": false, "orderable": false },
                 { "data": "productName", "name": "ProductName", "autoWidth": true},
                 { "data": "productCode", "name": "ProductCode", "autoWidth": true},
                 { "data": "parentProductId", "name": "ParentProductId", "autoWidth": true},
                 {
                    "data": "productId", render : function ( data, type, row, meta ) {
                    return type === 'display'  ?
                        '<a title="Update Product" class="btn btn-secondary mr-1 mb-1" href="/Product/UpdateProduct/?productId='+data+'" >Edit</a>'+
                        '<a title="Manage" class="btn btn-secondary mr-1 mb-1" href="/Role/ManageRole/?roleId='+data+'" >Manage</a>' +
                        '<a id ="delete-link-'+data+'" ProductName="'+row.ProductName+'" style="cursor:pointer;" title="Delete Product" onclick=DeletProduct("'+data+'") class="btn btn-danger mr-1 mb-1">Delete</a>' 
                        
                        :data;
                     },
                     "searchable": false,
                     "orderable": false,
                     "visible": true
                 }
            ],
            "language": {
                "emptyTable": "no data found"
            },
            "autoWidth": true
        });
    }
</script>
}